{"version":3,"file":"static/js/main.c838bc2f.js","mappings":"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","sources":["App.js","webpack/bootstrap","webpack/runtime/chunk loaded","webpack/runtime/compat get default export","webpack/runtime/define property getters","webpack/runtime/hasOwnProperty shorthand","webpack/runtime/make namespace object","webpack/runtime/jsonp chunk loading","webpack/startup"],"sourcesContent":["import React from 'react';\nimport { StyleSheet, Text, View, SafeAreaView, TextInput, Button, Alert } from 'react-native';\n\nexport default function App() {\n  const [text, handleText] = React.useState('');\n  const [response, setResponse] = React.useState('');\n\n  // https://qiita.com/_ytori/items/a92d69760e8e8a2047ac が実用的そう\n  React.useEffect(() => {\n    const websocket = new WebSocket('ws://localhost:8080/query', 'graphql-transport-ws');\n    websocket.onopen = function (event) {\n      console.log('この時点でWebSocketのコネクションは確立.以下で、GraphQL側とのハンドシェイク開始');\n      websocket.send('{\"type\":\"connection_init\",\"payload\":{}}');\n  \n      websocket.onmessage = (event) => {\n        console.log('GraphQL側からackを受けとる');\n        const connectionAck = JSON.parse(event.data);\n        if (connectionAck && connectionAck.type === 'connection_ack') {\n          console.log('ack確認後、以下で何をsubscribeしたいかをGraphQL側に通知(idは決め打ちしちゃってる。GraphQL用のクライアントライブラリ使った方がいいのかな)');\n  \n          const subscription = {\n            id: \"755f3598-629d-4058-9f90-1dc665db7316\",\n            payload: {\n              query: 'subscription {\\n  messageSent {\\n    id\\n    message\\n    createdAt\\n  }\\n}',\n            },\n            type: 'subscribe',\n          };\n          websocket.send(JSON.stringify(subscription));\n  \n          console.log('これ以降、他クライアントがpostしたメッセージをsubscription経由で受信できる');\n          // websocket.onmessage = function (event) {\n          //   console.log('Received:', JSON.parse(event.data));\n          // }\n          const onMessage = (event) => {\n            const data = JSON.parse(event.data);\n            console.log('Received:', data);\n            setResponse(prev => [...prev, data.payload.data.messageSent.message+'\\n']);\n          }\n          websocket.addEventListener('message', onMessage);\n\n          return () => {\n            websocket.close();\n            websocket.removeEventListener('message', onMessage);\n          }\n        }\n      }\n    }\n  },[])\n\n  const handleSubmit = () => {\n    fetch(\"http://localhost:8080/query\", {\n      \"headers\": {\n        \"content-type\": \"application/json\",\n      },\n      \"body\": `{\\\"query\\\":\\\"mutation($text: String!) {\\\\n  sendMessage(message: $text) {\\\\n    id\\\\n    message\\\\n    createdAt\\\\n  }\\\\n}\\\",\\\"variables\\\":{\\\"text\\\":\\\"${text}\\\"}}`,\n      \"method\": \"POST\",\n      \"mode\": \"cors\",\n      \"credentials\": \"omit\"\n    });\n\n    handleText('');\n  }\n\n  return (\n    <View style={styles.container}>\n      <Text>UltraChat📢</Text>\n      <Separator />\n      <SafeAreaView>\n        <TextInput\n          style={styles.input}\n          onChangeText={handleText}\n          placeholder=\"entry message...\"\n          value={text}\n        />\n        <Separator />\n        <Button\n          title=\"POST!\"\n          color=\"#f194ff\"\n          onPress={handleSubmit}\n        />\n      </SafeAreaView>\n      <Separator />\n      <Text>\n        {response}\n      </Text>\n    </View>\n  );\n}\n\nconst Separator = () => <View style={styles.separator} />;\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  separator: {\n    marginVertical: 8,\n    borderBottomColor: '#737373',\n    borderBottomWidth: StyleSheet.hairlineWidth,\n  },\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkweb\"] = self[\"webpackChunkweb\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [453], () => (__webpack_require__(4620)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["App","_React$useState","React","_React$useState2","_slicedToArray","text","handleText","_React$useState3","_React$useState4","response","setResponse","websocket","WebSocket","onopen","event","console","log","send","onmessage","connectionAck","JSON","parse","data","type","stringify","id","payload","query","onMessage","prev","concat","_toConsumableArray","messageSent","message","addEventListener","close","removeEventListener","_jsxs","View","style","styles","container","children","_jsx","Text","Separator","SafeAreaView","TextInput","input","onChangeText","placeholder","value","Button","title","color","onPress","fetch","separator","StyleSheet","flex","backgroundColor","alignItems","justifyContent","marginVertical","borderBottomColor","borderBottomWidth","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","deferred","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","length","fulfilled","j","Object","keys","every","key","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","forEach","bind","push","__webpack_exports__"],"sourceRoot":""}